document.addEventListener("DOMContentLoaded",()=>{u()});function u(){const e=document.getElementById("rebuildButton"),t=document.getElementById("suggestButton");e&&e.addEventListener("click",l),t&&t.addEventListener("click",c)}async function l(){const e=document.getElementById("rebuildButton"),t=document.getElementById("suggestButton");e&&e.setAttribute("disabled","true"),t&&t.setAttribute("disabled","true"),r("フォルダを再構築中...");try{const n=await chrome.runtime.sendMessage({action:"REBUILD_CENTROIDS"});console.log("フォルダ再構築の応答:",n),n&&n.ok?r("フォルダの再構築が完了しました"):i("フォルダの再構築中にエラーが発生しました")}catch(n){console.error("フォルダ再構築中にエラーが発生しました:",n),i("フォルダの再構築中にエラーが発生しました")}finally{e&&e.removeAttribute("disabled"),t&&t.removeAttribute("disabled")}}async function c(){const e=document.getElementById("rebuildButton"),t=document.getElementById("suggestButton");e&&e.setAttribute("disabled","true"),t&&t.setAttribute("disabled","true");const n=await chrome.tabs.query({active:!0,currentWindow:!0});if(n.length===0){i("アクティブなタブが見つかりません"),e&&e.removeAttribute("disabled"),t&&t.removeAttribute("disabled");return}const s=n[0];r("ページを分析中...");try{const o=await chrome.runtime.sendMessage({action:"SUGGEST_FOLDERS"});if(console.log("バックグラウンドスクリプトからの応答:",o),!o){i("バックグラウンドスクリプトからの応答がありません");return}o.result&&o.result.length>0?a(o.result,s):r("適切なフォルダが見つかりませんでした")}catch(o){console.error("エラーが発生しました:",o),i("ページの分析中にエラーが発生しました")}finally{e&&e.removeAttribute("disabled"),t&&t.removeAttribute("disabled")}}function r(e){const t=document.getElementById("status");t&&(t.textContent=e)}function i(e){r(`エラー: ${e}`)}function a(e,t){const n=document.getElementById("folderList");n&&(n.innerHTML="",r("推奨フォルダ:"),e.forEach(s=>{const o=document.createElement("div");o.className="folder-item",o.dataset.folderId=s.folderId,o.innerHTML=`
      <span class="folder-name">${s.name}</span>
    `,o.addEventListener("click",async()=>{try{await chrome.bookmarks.create({parentId:s.folderId,title:t.title,url:t.url}),r(`「${s.name}」にブックマークしました`),n.innerHTML="",setTimeout(()=>{window.close()},3e3)}catch(d){console.error("ブックマーク作成中にエラーが発生しました:",d),i("ブックマークの作成中にエラーが発生しました")}}),n.appendChild(o)}))}
//# sourceMappingURL=popup.js.map
